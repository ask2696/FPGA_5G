function output = qam_demod_custom(inp)
    
    %test_case
    %inp = [-0.948683586252911 - 0.948683586252911i;0.948683586252911 + ...
   % 0.316227862084304i;-0.948683586252910 - 0.948683586252911i;0.316227862084304 - 0.316227862084303i;0.316227862084303 - 0.316227862084304i;-0.316227862084304 - 0.948683586252910i;0.948683586252910 - 0.316227862084304i;0.316227862084304 - 0.948683586252911i;0.948683586252911 - 0.316227862084304i;0.948683586252911 - 0.948683586252911i;0.948683586252911 - 0.316227862084303i;0.948683586252911 + 0.316227862084304i;0.316227862084303 - 0.948683586252911i;0.948683586252911 - 0.316227862084304i;-0.316227862084304 + 0.316227862084304i;-0.948683586252911 + 0.948683586252911i;0.948683586252911 + 0.948683586252911i;-0.948683586252911 - 0.316227862084303i;-0.948683586252911 + 0.948683586252911i;-0.316227862084304 + 0.948683586252911i;0.316227862084304 + 0.316227862084304i;-0.948683586252911 - 0.316227862084304i;0.948683586252911 + 0.316227862084304i;-0.948683586252910 - 0.948683586252911i;0.948683586252910 + 0.948683586252911i;-0.316227862084303 - 0.948683586252911i;-0.948683586252911 + 0.316227862084304i;-0.316227862084303 - 0.316227862084303i;-0.948683586252911 - 0.948683586252910i;-0.316227862084304 - 0.948683586252911i;-0.948683586252911 - 0.316227862084303i;-0.316227862084304 - 0.948683586252911i;0.948683586252911 - 0.316227862084304i;-0.948683586252911 - 0.316227862084303i;0.316227862084303 - 0.316227862084303i;-0.948683586252911 + 0.316227862084304i;0.948683586252911 - 0.948683586252911i;0.948683586252911 - 0.316227862084304i;0.948683586252911 + 0.316227862084304i;-0.948683586252911 + 0.316227862084304i;-0.316227862084303 + 0.948683586252911i;0.316227862084303 + 0.948683586252911i;-0.316227862084304 + 0.316227862084304i;-0.316227862084303 + 0.948683586252911i;-0.316227862084304 - 0.316227862084304i;0.316227862084304 - 0.316227862084304i;0.948683586252911 + 0.316227862084303i;0.948683586252911 - 0.948683586252911i;-0.948683586252910 + 0.316227862084304i;-0.316227862084304 + 0.316227862084303i;-0.316227862084303 - 0.316227862084304i;0.316227862084304 - 0.948683586252911i;-0.316227862084304 + 0.948683586252910i;-0.316227862084304 + 0.316227862084304i;0.316227862084304 + 0.948683586252911i;0.948683586252911 + 0.948683586252911i;-0.316227862084304 - 0.948683586252911i;-0.948683586252911 - 0.316227862084303i;-0.948683586252911 - 0.316227862084304i;0.948683586252911 + 0.316227862084303i;-0.948683586252911 + 0.316227862084304i;0.316227862084304 + 0.948683586252910i;-0.948683586252911 + 0.316227862084303i;0.316227862084303 - 0.316227862084303i;0.316227862084303 - 0.948683586252911i;-0.948683586252911 + 0.948683586252911i;0.316227862084303 + 0.948683586252911i;0.948683586252911 + 0.948683586252911i;-0.316227862084303 - 0.948683586252911i;0.316227862084304 + 0.316227862084304i;-0.948683586252910 + 0.316227862084303i;0.316227862084303 - 0.316227862084304i;-0.948683586252911 + 0.948683586252910i;0.948683586252910 - 0.948683586252911i;-0.316227862084304 + 0.316227862084303i;-0.316227862084304 + 0.316227862084304i;-0.316227862084303 + 0.948683586252911i;-0.316227862084304 + 0.948683586252911i;0.316227862084304 + 0.316227862084304i;0.948683586252911 - 0.948683586252910i;-0.316227862084304 - 0.948683586252911i;0.316227862084304 + 0.948683586252911i;-0.948683586252911 - 0.948683586252911i;0.316227862084304 - 0.948683586252911i;0.316227862084303 + 0.948683586252911i;-0.316227862084304 - 0.948683586252910i;-0.316227862084304 - 0.948683586252911i;-0.316227862084304 - 0.316227862084303i;0.948683586252911 - 0.316227862084303i;-0.316227862084304 - 0.948683586252911i;0.316227862084304 + 0.316227862084304i;0.316227862084304 - 0.948683586252911i;0.948683586252911 - 0.316227862084303i;-0.948683586252911 - 0.948683586252911i;-0.316227862084304 + 0.948683586252911i;-0.316227862084304 - 0.316227862084304i;-0.316227862084304 + 0.316227862084304i;0.948683586252911 - 0.316227862084304i;0.948683586252911 + 0.316227862084303i;-0.948683586252911 - 0.948683586252911i;0.316227862084303 - 0.948683586252911i;0.948683586252911 - 0.316227862084303i;-0.316227862084303 - 0.948683586252911i;-0.316227862084303 + 0.948683586252911i;-0.316227862084303 - 0.948683586252911i;0.316227862084304 + 0.948683586252911i;-0.316227862084303 + 0.316227862084303i;-0.948683586252911 - 0.316227862084304i];
    
    %%% Wave form analysis
    
    output = zeros(size(inp,1)*4,1);
    
    mapping_qam = [-0.948683298050514 + 0.948683298050514i,-0.948683298050514 + 0.316227766016838i,-0.948683298050514 - 0.948683298050514i,-0.948683298050514 - 0.316227766016838i,-0.316227766016838 + 0.948683298050514i,-0.316227766016838 + 0.316227766016838i,-0.316227766016838 - 0.948683298050514i,-0.316227766016838 - 0.316227766016838i,0.948683298050514 + 0.948683298050514i,0.948683298050514 + 0.316227766016838i,0.948683298050514 - 0.948683298050514i,0.948683298050514 - 0.316227766016838i,0.316227766016838 + 0.948683298050514i,0.316227766016838 + 0.316227766016838i,0.316227766016838 - 0.948683298050514i,0.316227766016838 - 0.316227766016838i];
    bin_out = [0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1;0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1;0,0,1,1,0,0,1,1,0,0,1,1,0,0,1,1;0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1];;
    %val = @(inp) inp(1,1)*2^3+inp(2,1)*2^2+inp(3,1)*2^1+inp(4,1)*2^0;
    
    i1 = 1;
    
    for i= 1:size(inp,1)
        
        [X,bin_val] = min(abs(inp(i,1) -mapping_qam));
        output(i1:i1+3,1) = bin_out(:,bin_val);
        i1 = i1+4;
    end


end